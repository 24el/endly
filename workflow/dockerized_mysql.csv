Workflow,,Name,Description,Tasks,,,Variables,,,
,,dockerized_mysql,This workflow will setup and start mysql as docker service,%Tasks,,,#dockerized_mysql_var.json,,,
[]Tasks,Step,Name,Description,Actions,,RunCriteria,,,,
,1,system_stop_mysql,"This task will stop system mysql if it is running, it only run if  $param.stopSystemMysql is true",%Actions1,,$params.stopSystemMysql:true,,,,
[]Actions1,Service,Action,Description,Request.Service,Request.Target,RunCriteria,Variables,,,
,system,status,Check if system mysql service is running,mysql,$remoteTarget,,"[{""name"":""mysqlSystemStatus"", ""source"":""State"", ""scope"":""out""}]",,,
,system,stop,Stop system mysql service,mysql,$remoteTarget,$mysqlSystemStatus:running,,,,
[]Tasks,Step,Name,Description,Actions,,RunCriteria,,,,
,2,system_start_docker,This task wil start system docker service it it is not running,%Actions2,,,,,,
[]Actions2,Service,Action,Description,Request.Service,Request.Target,RunCriteria,Variables,,,
,system,status,Check if system docker service is running,docker,$remoteTarget,,"[{""name"":""dockerSystemStatus"", ""source"":""State"", ""scope"":""out""}]",,,
,system,start,Start docker service,docker,$remoteTarget,$dockerSystemStatus:/!running/,,,,
[]Tasks,Step,Name,Description,Actions,,RunCriteria,,,,
,3,prepare_config,This task will create my.cnf mysql configuration file ($params.mycnfURL),%Actions3,,,,,,
[]Actions3,Service,Action,Description,Request.[]Transfers,,RunCriteria,Variables,,,
,transfer,copy,This action will copy template my.cnf to the temp folder,$mycnfTransfer,,$params.mycnfUrl:/!params.mycnfUrl/,,,,
[]Tasks,Step,Name,Description,Actions,,RunCriteria,,,,
,4,docker_run_mysql,This task will start docker mysql instance,%Actions4,,,,,,
[]Actions4,Service,Action,Description,Request.Image,Request.Target,Request.MappedPort,Request.Env,Request.Credential,Request.Mount,Request.SysPath
,docker,run,Start docker mysql service,mysql:5.6,$remoteTarget,"{""3306"":""3306""}","{""MYSQL_ROOT_PASSWORD"": ""****""}",${env.HOME}/secret/mysql.json,"{""$mycnfFile"":""/etc/my.cnf""}","[""/usr/local/bin""]"
