{
  "Name": "node",
  "Versioning": "MajorVersion.MinorVersion.ReleaseVersion",
  "Targets": [
    {
      "MinReleaseVersion": {
        "7.0": "0",
        "7.9": "0",
        "8.0": "0",
        "8.11": "1",
        "9.0": "0",
        "9.9": "0",
        "10.15": "0",
        "11.12": "0"
      },
      "Deployment": {
        "Pre": {
          "AutoSudo": true,
          "Commands": [
            "mkdir -p ${deploy.baseLocation}/",
            "chmod a+rw ${deploy.baseLocation}/"
          ]
        },
        "Transfer": {
          "Source": {
            "URL": "https://nodejs.org/dist/v${artifact.Version}/node-v${artifact.Version}-${os.System}-${os.Arch}.tar.gz"
          },
          "Dest": {
            "URL": "scp://${deploy.target.host}${deploy.baseLocation}/node_${artifact.Version}.tar.gz",
            "Credentials": "${deploy.target.credentials}"
          }
        },
        "VersionCheck": {
          "SystemPaths": [
            "${deploy.baseLocation}/node/bin"
          ],
          "Commands": [
            {
              "Command": "node -v",
              "Extract": [
                {
                  "Key": "Version",
                  "RegExpr": "v(\\d+\\.\\d+)"
                }
              ]
            }
          ]
        },
        "Run": {
          "Directory": "${deploy.baseLocation}",
          "TimeoutMs": 120000,
          "Commands": [
            {
              "Command": "/bin/bash -c '[[ -e ${deploy.baseLocation}/node ]] && rm -rf ${deploy.baseLocation}/node'"
            },
            {
              "Command": "tar xvzf node_${artifact.Version}.tar.gz",
              "Error": [
                "Error",
                "No such file or directory"
              ]
            },
            {
              "Command": "mv node-v${artifact.Version}-${os.System}-${os.Arch} node",
              "Error": [
                "Error",
                "No such file or directory"
              ]
            }
          ]
        }
      }
    }
  ],
  "BaseLocation": "/usr/local"

}